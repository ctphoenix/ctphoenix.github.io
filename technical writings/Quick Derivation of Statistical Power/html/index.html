<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Derivation of the Power Equation - Patrick Staples</title>
    <link rel="stylesheet" href="../../../styles/main.css">
    <!-- MathJax for rendering LaTeX -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  </head>
  <body>
    <div class="top-container">
      <div class="content-container">
        <header class="site-header">
          <h1 class="brand">Patrick Staples</h1>
        </header>
        
        <nav>
          <div class="nav-content">
            <span class="nav-item">
              <a href="../../../index.html">Home</a>
            </span>
            <span class="nav-item active">
              <a href="../../../technical-writings.html">Technical Writings</a>
            </span>
            <span class="nav-item">
              <a href="../../../music.html">Music</a>
            </span>
            <span class="nav-item">
              <a href="https://www.linkedin.com/in/patrick-staples/" target="_blank">LinkedIn</a>
            </span>
            <span class="nav-item">
              <a href="https://scholar.google.com/citations?user=obAll0UAAAAJ" target="_blank">Google Scholar</a>
            </span>
          </div>
        </nav>
        
        <main>
          <div class="breadcrumbs">
            <a href="../../../technical-writings.html">← Back to Technical Writings</a>
          </div>
          
          <h1>Derivation of the Power Equation</h1>
          
          <div class="math-content">
            <p>Typically, statistical power calculations seem to come from nowhere, although they contain elements of notation that are somewhat familiar. This is a compact derivation of the power calculation, in the simple case of one sample.</p>
            
            <p>By the central limit theorem,</p>
            <p>\begin{align*}
            \frac{\bar{x} - \mu_0}{\sigma/\sqrt{n}}  \sim Z\ \big|\ \text{H}_0 \\
            \frac{\bar{x} - \mu_A}{\sigma/\sqrt{n}}  \sim Z\ \big|\ \text{H}_A
            \end{align*}</p>
            
            <p>where \(Z\) is distributed standard normal. Rearranging:</p>
            
            <p>\begin{align*}
            \bar{x} &\sim \frac{\sigma}{\sqrt{n}}Z + \mu_0\ \big|\ \text{H}_0 \\
            \bar{x} &\sim \frac{\sigma}{\sqrt{n}}Z + \mu_A\ \big|\ \text{H}_A
            \end{align*}</p>
            
            <p>Without loss of generality, let \(\mu_A > \mu_0\). The situation looks like this:</p>
            
            <figure class="figure">
              <img src="normals.png" alt="Normal distributions under null and alternative hypotheses" style="width:70%; margin:auto; display:block;">
              <figcaption>The shaded regions are where the null is rejected under the two hypotheses.</figcaption>
            </figure>
            
            <p>We want to find the \(x\)-value where the yellow line is. Let's call it \(Z_c\). We want \(Z_c\) to satisfy the two properties:</p>
            
            <p>\begin{align*}
            \mathbb{P}(\bar{x} < Z_c \big|\ \text{H}_0) &= 1 - \alpha\\
            \mathbb{P}(\bar{x} < Z_c \big|\ \text{H}_A) &= \beta
            \end{align*}</p>
            
            <p>These are met respectively when the following two equations hold:</p>
            
            <p>\begin{align*}
            Z_c &= \mu_0 + \frac{\sigma}{\sqrt{n}}Z_{1 - \alpha} \\
            Z_c &= \mu_A + \frac{\sigma}{\sqrt{n}}Z_{\beta} = \mu_A - \frac{\sigma}{\sqrt{n}}Z_{1 - \beta}
            \end{align*}</p>
            
            <p>Because both are equal to \(Z_c\), we can drop it and set the two right-hand side expressions as equal:</p>
            
            <p>\begin{align*}
            \mu_0 + \frac{\sigma}{\sqrt{n}}Z_{1 - \alpha} = \mu_A - \frac{\sigma}{\sqrt{n}}Z_{1 - \beta}
            \end{align*}</p>
            
            <p>Solving for \(n\), we have:</p>
            
            <p>\begin{align*}
            \mu_A - \mu_0 &= \frac{\sigma}{\sqrt{n}}\big[Z_{1 - \alpha} + Z_{1 - \beta}\big] \\
            \Rightarrow\quad \boxed{n &= \left[\frac{\sigma(Z_{1 - \alpha} + Z_{1 - \beta})}{\mu_A - \mu_0}\right]^2} \\
            \end{align*}</p>
            
            <p>The different flavors of power calculation come from:</p>
            
            <ul>
              <li>two-sided tests (just substitute \(Z_{1-\alpha/2}\) in place of \(Z_{1-\alpha}\))</li>
              <li>hypothesis testing using a more complicated statistic, like \(\bar{x}_1-\bar{x}_2\)</li>
              <li>using a different finite-sample approximation for the distribution of \(\bar{x}\).</li>
            </ul>
          </div>
          
          <div class="breadcrumbs">
            <a href="../../../technical-writings.html">← Back to Technical Writings</a>
          </div>
        </main>
      </div>
    </div>
    
    <footer class="site-footer">
      <span class="footer-item">
        Patrick Staples
      </span>
      <span class="footer-item">
        <a href="https://www.linkedin.com/in/patrick-staples/" target="_blank">LinkedIn</a>
      </span>
      <span class="footer-item">
        <a href="https://scholar.google.com/citations?user=obAll0UAAAAJ" target="_blank">Google Scholar</a>
      </span>
    </footer>
  </body>
</html>